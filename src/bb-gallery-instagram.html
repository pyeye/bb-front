<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/app-layout/app-grid/app-grid-style.html">
<link rel="import" href="../bower_components/paper-styles/typography.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">

<link rel="import" href="../bower_components/neon-animation/neon-shared-element-animatable-behavior.html">
<link rel="import" href="../bower_components/neon-animation/neon-animatable-behavior.html">
<link rel="import" href="../bower_components/neon-animation/animations/hero-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/ripple-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-in-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/slide-from-bottom-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/cascaded-animation.html">

<link rel="import" href="bb-icons.html">

<dom-module id="bb-gallery-instagram">

  <template>

  <style>
    .content {
        margin: 24px auto;
        width: 80%;
        @apply --layout-horizontal;
        @apply --layout-wrap;
    }

    .image {
        position: relative;
        width: 100%;
        height: 100%;
    }

    .image-item {
        position: relative;
        margin: 8px;
        display: inline-block;
        -webkit-flex: 1 1;
        flex: 1 1;
        -webkit-flex-basis: 30%;
        flex-basis: 30%;
        max-width: 30%;
        cursor: pointer;
        box-shadow: 0 3px 4px 0 rgba(0, 0, 0, 0.14),
                    0 1px 8px 0 rgba(0, 0, 0, 0.12),
                    0 3px 3px -2px rgba(0, 0, 0, 0.4);
    }

    .item-title {
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        opacity: 0;
        background-color: rgba(0, 0, 0, 0.3);
        color: #fff;
        @apply --layout-horizontal;
        @apply --layout-center;
        @apply --layout-center-justified;
        @apply --paper-font-subhead;
    }

    .item-title:hover {
        opacity: 1;
    }

    a {
        text-decoration: none;
        color: #fff;
    }

    .item-title iron-icon {
        --iron-icon-fill-color: #FFFFFF;
        --iron-icon-height: 24px;
        --iron-icon-width: 24px;
        
      }
      
      .title-text {
          margin-left: 4px;
          font-weight: 600;
      }

      #comment-icon {
        margin-left: 32px;
      }

      @media (max-width: 1450px) {
               .content {
       
        width: 90%;
        
    }
            }

            @media (max-width: 1050px) {
                .content {
       
        width: 90%;
        
    }
    .image-item {
        
        -webkit-flex-basis: 47%;
        flex-basis: 47%;
        max-width: 47%;
        
    }
            }

            @media (max-width: 550px) {
.content {
       
        width: 95%;
        
    }
    .image-item {
        
        -webkit-flex-basis: 100%;
        flex-basis: 100%;
        max-width: 100%;
        
    }
                
            }
    

  </style>

  

    <iron-ajax id="ajax"
                auto
                url="https://borisbar.ru/api/v1/instagram/"
                handle-as="json"
                last-response="{{instagram}}"></iron-ajax>


    <div id="content" class="content" has-content$="[[_isDefined(instagram)]]">
        <template items="[[instagram]]" is="dom-repeat">
            
            <div class="image-item">
                <a target="_blank" href="https://www.instagram.com/p/[[item.short_code]]/">
                <img class="image" src="[[item.img]]" >
                <div class="item-title">
                    <iron-icon icon="favorite"></iron-icon> <div class="title-text">[[item.likes]] –</div> <iron-icon id="comment-icon" icon="mode-comment"></iron-icon><div class="title-text">[[item.comments_count]] –</div>
                </div>
                </a>
            </div>
            
        </template>
        
    </div>
  
  


</template>

  <script>

    Polymer({

      is: 'bb-gallery-instagram',

      properties: {
        
animationConfig: {
          value: function() {
            return {
              'entry': [
                 {
                  name: 'fade-in-animation',
                  node: this.$.content,
                }],
              'exit': [
                {
                  name: 'fade-out-animation',
                  node: this,
                }]
            }
          }
        },
        

       
      },

      behaviors: [
        Polymer.NeonAnimatableBehavior,
        Polymer.IronResizableBehavior],

     

      _isDefined: function(instagram) {
        return instagram != null;
      },

      attached: function() {
        this._updateGridStyles = this._updateGridStyles || function() {
          this.updateStyles();
        }.bind(this);
        window.addEventListener('resize', this._updateGridStyles);
      },

      detached: function() {
        window.removeEventListener('resize', this._updateGridStyles);
      },

      _itemTapHandler: function(e) {
        this.sharedElements['album-hero'] = e.currentTarget;
        this.sharedElements['album-ripple'] = e.currentTarget;
        this.fire('redirect-to-album', {'pk': e.model.item.pk});
      }

    });

  </script>

</dom-module>
